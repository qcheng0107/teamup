<div class="page-header">
  <h3><%= @session.course_name %></h3>
  <body><%= @session.quarter %></body>
  <a href="/sessions/<%= @session.id %>/edit" class="btn btn-warning">
    <i class="fa fa-edit"></i>
  </a>
</div>

<!-- A Session has many registrations -->

<div class="row">
  <div class="col-md-12">
    <ul class="list-group">
      <li class="list-group-item list-group-item-info">
        All Enrolled Students
      </li>

      <% @session.registrations.each do |registration| %>
        <li class="list-group-item">
          <a href="/users/<%= registration.user.id %>">
            <%= registration.user.dropdown_name %>
          </a>
          <div class="btn-group btn-group-xs pull-right">
            <% if current_user == registration.user %>
            <a href="/registrations/<%= registration.id %>/edit" class="btn btn-warning">
              <i class="fa fa-edit"></i>
            </a>
            <a href="/delete_registration/<%= registration.id %>" class="btn btn-danger" rel="nofollow">
              <i class="fa fa-trash-o"></i>
            </a>
            <% end %>
          </div>
        </li>
      <% end %>

      <% registration = Registration.find_by(session_id: @session.id, user_id: current_user.id) %>
       <% unless registration.present? %>
        <dd class="list-group-item">
          <form action="/create_registration" method="post">
            <input name="authenticity_token" type="hidden" value="<%= form_authenticity_token %>">
            <input type="hidden" name="user_id" value="<%= current_user.id %>">
            <input type="hidden" name="session_id" value="<%= @session.id %>">
    
            <button class="btn btn-block btn-success">
              Register for this Session
            </button>
          </form>
        </dd>
       <% end %> 
    </ul>
  </div>
</div>

<!-- A Session has many teams -->

<div class="row">
  <div class="col-md-12">
    <ul class="list-group">
      <li class="list-group-item list-group-item-info">
        All Teams
      </li>

    <% @session.teams.each do |team| %>
      <li class="list-group-item">
      <% member = Member.find_by(team_id: team.id, user_id: current_user.id) %>
        <a href="/teams/<%= team.id %>">
          <%= team.team_name %>
        </a>
      <% registration = Registration.find_by(session_id: @session.id, user_id: current_user.id) %>
      <% if registration.present? %> 
        <% if member.present? %>
            <div class="btn-group btn-group-xs pull-right">
              <a href="/teams/<%= team.id %>/edit" class="btn btn-warning">
                <i class="fa fa-edit"></i>
              </a>
              <a href="/delete_team/<%= team.id %>" class="btn btn-danger" rel="nofollow">
                <i class="fa fa-trash-o"></i>
              </a>
            </div>
        <% end %>
      
        <% myteam = Team.find_by(session_id: @session.id, user_id: current_user.id) %>
        <% unless myteam == nil %>
          <li class="list-group-item">
            <form action="/create_team" method="post">
              <input name="authenticity_token" type="hidden" value="<%= form_authenticity_token %>">
              <input type="hidden" name="session_id" value="<%= @session.id %>">
              <input type="hidden" name="user_id" value="<%= current_user.id %>">
          
              <div class="form-group">
                <input type="text" id="team_name" name="team_name" placeholder="Team name" class="form-control" value="">
              </div>
                
              <button class="btn btn-block btn-success">
                Create Team
              </button>
            </form>
          </li>
        <% end %>
      
      <% end %>
    <% end %>
    </ul>
  </div>
</div>
